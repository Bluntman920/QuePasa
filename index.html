<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Que Pasa</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <style>
    html, body { height: 100%; margin: 0; padding: 0; }
    body {
      min-height: 100vh;
      background: #23272a;
      color: #fff;
      font-family: 'Segoe UI', Arial, sans-serif;
      overflow: hidden;
    }
    .screen {
      width: 100vw;
      height: 100vh;
      display: none;
      align-items: center;
      justify-content: center;
      flex-direction: column;
      position: absolute;
      left: 0; top: 0;
      background: #23272a;
      z-index: 1;
    }
    .screen.active {
      display: flex;
      z-index: 10;
    }
    .logo {
      width: 37vw;
      max-width: 280px;
      min-width: 120px;
      aspect-ratio: 1/1;
      margin-bottom: 28px;
      user-select: none;
    }
    .app-title {
      font-size: 3em;
      color: #f1c40f;
      font-weight: bold;
      letter-spacing: 0.03em;
      margin-bottom: 12px;
      text-shadow: 0 2px 24px #0009;
      user-select: none;
    }
    .tap-to-enter {
      margin-top: 52px;
      color: #fff7;
      font-size: 1.1em;
      animation: blink 1.2s linear infinite alternate;
      user-select: none;
      cursor: pointer;
    }
    @keyframes blink {
      0% { opacity: 1;}
      100% { opacity: 0.2;}
    }
    .menu-btn {
      width: 70vw;
      max-width: 330px;
      min-width: 160px;
      padding: 20px 0;
      margin: 18px 0;
      border-radius: 10px;
      border: none;
      background: #1da365;
      color: #fff;
      font-size: 1.3em;
      font-weight: bold;
      cursor: pointer;
      transition: background 0.18s, transform 0.15s;
      box-shadow: 0 2px 8px #0002;
    }
    .menu-btn:hover {
      background: #149150;
      transform: translateY(-2px) scale(1.03);
    }
    /* Host Room */
    .room-code {
      font-size: 1.8em;
      color: #f1c40f;
      background: #222b;
      padding: 16px 30px;
      border-radius: 14px;
      margin-top: 32px;
      margin-bottom: 18px;
      letter-spacing: 0.25em;
      user-select: all;
      font-family: 'Courier New', Courier, monospace;
      box-shadow: 0 2px 8px #0002;
    }
    .room-qr {
      margin: 18px 0 8px 0;
      background: #fff;
      border-radius: 12px;
      padding: 12px;
      box-shadow: 0 2px 8px #0003;
      display: inline-block;
    }
    .label {
      font-size: 1.1em;
      margin-bottom: 8px;
      color: #fff8;
    }
    .big-flash {
      width: 100vw;
      height: 100vh;
      background: #23272a;
      position: fixed;
      left: 0; top: 0;
      z-index: 9999;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 7em;
      color: #f1c40f;
      user-select: none;
      transition: background 0.2s;
      text-align: center;
      flex-direction: column;
    }
    .big-flash img {
      width: 44vw;
      max-width: 340px;
      min-width: 110px;
      margin-bottom: 0;
    }
    .big-flash .flash-logo {
      color: #f1c40f;
      font-size: 0.7em;
    }
    .big-flash .flash-qr {
      background: #fff;
      border-radius: 16px;
      padding: 20px;
      box-shadow: 0 2px 12px #0007;
    }
    .flash-btn {
      background: #fff3;
      color: #f1c40f;
      font-size: 1.25em;
      border: none;
      padding: 14px 34px;
      border-radius: 10px;
      margin: 20px 12px;
      cursor: pointer;
      font-weight: bold;
      letter-spacing: 0.04em;
      box-shadow: 0 2px 8px #0002;
      transition: background 0.17s, color 0.17s;
    }
    .flash-btn:hover {
      background: #f1c40f;
      color: #23272a;
    }
    .leave-btn {
      background: #e74c3c;
      color: #fff;
      padding: 12px 28px;
      border-radius: 9px;
      border: none;
      font-size: 1em;
      font-weight: bold;
      margin-top: 30px;
      cursor: pointer;
      transition: background 0.13s;
    }
    .leave-btn:hover {
      background: #c0392b;
    }
    @media (max-width: 480px) {
      .logo { max-width: 160px; }
      .app-title { font-size: 2em; }
      .room-code { font-size: 1.1em; }
      .big-flash { font-size: 2.7em; }
      .big-flash img { max-width: 120px; }
    }
  </style>
  <script src="https://cdn.jsdelivr.net/npm/qrious@4.0.2/dist/qrious.min.js"></script>
</head>
<body>
  <!-- Splash Screen -->
  <div class="screen active" id="splash">
    <img class="logo" src="https://upload.wikimedia.org/wikipedia/commons/2/2f/Que_Pasa_logo_placeholder.svg" alt="Que Pasa logo" />
    <div class="app-title">Que Pasa</div>
    <div class="tap-to-enter" id="splashEnter">Tap to Start</div>
  </div>
  <!-- Host Room Screen -->
  <div class="screen" id="hostRoomScreen">
    <div class="label">Room QR Code (flash to invite):</div>
    <canvas id="qrCanvas" class="room-qr"></canvas>
    <div class="room-code" id="roomCodeDisplay"></div>
    <div>
      <button class="flash-btn" id="flashQrBtn">Show QR Fullscreen</button>
      <button class="flash-btn" id="flashCodeBtn">Flash Code Letters</button>
    </div>
    <button class="leave-btn" id="leaveHostBtn">End Room</button>
  </div>
  <!-- Big flash overlay (for code/QR/logo) -->
  <div class="big-flash" id="bigFlash" style="display:none;">
    <!-- Will be filled dynamically -->
  </div>
  <script>
    // Helper: Generate random code (A-Z, 2-9), always unique, always random, 6 chars
    function makeRoomCode() {
      const chars = "ABCDEFGHJKMNPQRSTUVWXYZ23456789";
      let code = "";
      for (let i = 0; i < 6; ++i) code += chars[Math.floor(Math.random() * chars.length)];
      return code;
    }

    // Helper: Draw QR code to a canvas
    function drawQR(canvasId, text, size=180) {
      new QRious({
        element: document.getElementById(canvasId),
        value: text,
        size,
        background: '#fff',
        foreground: '#111'
      });
    }

    // State
    let hostRoomCode = null;

    // Splash logic
    document.getElementById('splashEnter').onclick = () => setupHostRoom();
    document.getElementById('splash').onclick = () => setupHostRoom();

    // Setup host room screen (simulate: just the code/QR for this demo)
    function setupHostRoom() {
      // Generate a new random code each time
      hostRoomCode = makeRoomCode();
      document.getElementById('roomCodeDisplay').textContent = hostRoomCode.split('').join(' ');
      drawQR('qrCanvas', hostRoomCode);
      show('hostRoomScreen');
    }

    // Show/hide screens
    function show(screen) {
      document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
      document.getElementById(screen).classList.add('active');
    }

    // Show QR code full screen
    document.getElementById('flashQrBtn').onclick = () => {
      // Flash logo, then QR, then logo again
      flashSequence([
        { type: 'logo', duration: 800 },
        { type: 'qr', duration: 2000 },
        { type: 'logo', duration: 700 }
      ]);
    };

    // Show each letter/number big, with logo flash before and after
    document.getElementById('flashCodeBtn').onclick = () => {
      const code = hostRoomCode;
      const seq = [{ type: 'logo', duration: 800 }];
      for (let ch of code) {
        seq.push({ type: 'letter', letter: ch, duration: 800 });
      }
      seq.push({ type: 'logo', duration: 700 });
      flashSequence(seq);
    };

    // End room
    document.getElementById('leaveHostBtn').onclick = () => {
      hostRoomCode = null;
      show('splash');
    };

    // Flash sequence (for letters/qr/logo)
    function flashSequence(seq) {
      const flash = document.getElementById('bigFlash');
      let i = 0;
      flash.style.display = 'flex';
      next();
      function next() {
        if (i >= seq.length) {
          flash.style.display = 'none';
          return;
        }
        flash.innerHTML = ""; // Clear
        const item = seq[i++];
        if (item.type === "logo") {
          // You can swap this with your real logo!
          flash.innerHTML = `<img src="https://upload.wikimedia.org/wikipedia/commons/2/2f/Que_Pasa_logo_placeholder.svg" alt="Que Pasa logo" class="flash-logo" />`;
        } else if (item.type === "letter") {
          flash.textContent = item.letter;
        } else if (item.type === "qr") {
          // Dynamically create a canvas for QR
          const qrCanvas = document.createElement('canvas');
          qrCanvas.width = qrCanvas.height = 320;
          qrCanvas.className = "flash-qr";
          flash.appendChild(qrCanvas);
          new QRious({
            element: qrCanvas,
            value: hostRoomCode,
            size: 320,
            background: '#fff',
            foreground: '#23272a'
          });
        }
        setTimeout(next, item.duration);
      }
    }
  </script>
</body>
</html>
